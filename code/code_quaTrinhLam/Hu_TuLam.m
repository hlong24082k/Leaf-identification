
I = imread('E:\Nhom8A\thi cuoi ki\front1.jpeg');

[m,n]=size(I);
xd=0;
yd=0;
S=0;
for i=1:m
for j=1:n
xd= xd+i*I(i,j);
yd= yd+j*I(i,j);
S=S+I(i,j);
end
end
xd=xd/S;
yd=yd/S;
m = zeros(4);
[a b] = size(I);
for p = 0:3
for q = 0:3
for i = 1:a
for j = 1 : b
m(p+1,q+1)= m(p+1,q+1) + ((i-x).^p).*((j-y).^q).*I(i,j);
    end
end
end
end
M = zeros(4);
for p = 0:3
for q = 0:3
M(p+1,q+1) = m(p+1,q+1)./(m(1,1).^((p+q)/2 +1));
end
end
S1 = M(3,1) + M(1,3);
S2 = (M(3,1)-M(1,3))*(M(3,1)+M(1,3)) + 4*M(2,2)*M(2,2);
S3 = ((M(4,1)-3*M(2,3)).^(2)) + ((M(4,1)+3*M(2,3)).^(2));
S4= (M(4,1)+M(2,3)).^2+((M(1,4)+M(3,2)).^2);
S5 = ((M(4,1)-3*M(2,3))*(M(4,1)+M(2,3))*((M(4,1)+M(2,3)).^2)-3*((M(1,4)+M(3,2)).^2))+3*(M(3,2)-M(1,4))*(M(1,4)+M(3,2))*(3*((M(4,1)+M(2,3)).^2)-(M(1,4)+M(3,2)).^2);
S6 = (M(3,1)-M(1,3))*(((M(4,1)+M(2,3)).^2)-((M(1,4)+M(3,2)).^2))+4*M(2,2)*(M(4,1)+ M(2,3))*(M(1,4)+M(3,2));
S7 = (3*(M(3,2)-M(1,4))*(M(4,1)+M(2,3))*((M(4,1)+M(2,3)).^2)-3*((M(1,4)+M(3,2)).^2))+(M(4,1)-3*M(2,3))*(M(3,2)+M(1,3))*(3*((M(4,1)+M(2,3)).^2)-(M(1,4)+M(3,2)).^2);
S1 = log(abs(S1));
S2 = log(abs(S2));
S3 = log(abs(S3));
S4 = log(abs(S4));
S5 = log(abs(S5));
S6 = log(abs(S6));
S7 = log(abs(S7));
E(ix,1)=S1;
E(ix,2)=S2;
E(ix,3)=S3;
E(ix,4)=S4;
E(ix,5)=S5;
E(ix,6)=S6;
E(ix,7)=S7;

